<!DOCTYPE html>
<html lang="en">

<head>
    <title>Phantasma Contract Tester</title>

    <!-- Stuff Needed for Clean Run -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css"
        crossorigin="anonymous">
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" crossorigin="anonymous"></script>

    <!-- PhantasmaLink Stuff -->
    <script src="https://cdn.jsdelivr.net/gh/ncwardell/PhantasmaContractTester/stuff/phantasma.js"></script>
    <script
        src="https://cdn.jsdelivr.net/gh/phantasma-io/PhantasmaLink/Dapps/www/public/Shared/validator.min.js"></script>
    <link href="https://cdn.jsdelivr.net/gh/phantasma-io/PhantasmaLink/Dapps/www/public/Shared/phantasma.css"
        rel="stylesheet">

    <!-- Decoding N Junk -->
    <script src="https://peterolson.github.io/BigInteger.js/BigInteger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/ncwardell/PhantasmaContractTester/stuff/decoder.js"></script>

    <!-- Customs -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ncwardell/PhantasmaContractTester/stuff/basics.css">
    <script src="https://cdn.jsdelivr.net/gh/ncwardell/PhantasmaContractTester/stuff/basics.js"></script>


</head>

<body>

    <!-- Script To Connect -->
    <script>

        //The Name of your dapp
        dappName = 'Phantasma Contract Tester';

        //Set Document inputs to Used Variables
        _contractName = "contractName";
        _methodName = "methodName";
        _inputArguments = "inputArguments"
        _scriptData = "scriptInput";
        _return = "returnBox";
        
        //Create The Link
        let link = new PhantasmaLink(dappName); //Here we instantiate a Phantasma Link connection

        //Toggle's to Manual Mode or Script Mode
        function toggle() {
            if (document.getElementById("scriptInputs").style.display === "none") {
                document.getElementById("manualInputs").style.display = "none";
                document.getElementById("scriptInputs").style.display = "block";
            } else {
                document.getElementById("scriptInputs").style.display = "none";
                document.getElementById("manualInputs").style.display = "block";
            }
        };
        
        function gasProfileToggle(){
            if(document.getElementById("gasProfileCheckbox").checked === "false"){
                _gasProfile = false;
            }else{
                _gasProfile = true;
            }
        }
        
        function sendDonationScript(){
            
            const sb = new ScriptBuilder();
            
            let theScript = sb
                sb.callInterop("Runtime.TransferTokens", 
                [
                    link.account.address,
                    'P2K4WNwqRe1Zcfvdde9gAnDLR3TPDEn8kLdBFuB4rAzRSvU',
                    'KCAL',
                    2000000000,
                ])
                .endScript();
                
                sendTransaction(theScript);
        }
        
        async function transactionSend(){
            sendTransaction(await getDocumentValue(_scriptData))
        }
        
         async function invokeSend(){
            invokeTransaction(await getDocumentValue(_scriptData))
        }



    </script>

    <div
        style="background-image: url('https://static.vecteezy.com/system/resources/thumbnails/001/905/573/small/blue-grunge-background-free-photo.jpg'); background-repeat: no-repeat; background-position: center; background-size: cover; height: 100vh;">
        <br><br>
        <div class="baseCard">
            <br>

            <div style="margin:auto;text-align:center; font-size: 28px; color: white; font-weight: bold;">Phantasma
                Contract Tester
            </div>

            <div style="width:320px;height:85px;margin:auto;display:flex">
                <div style="width:100px;height:45px;margin:20px;display:inline-flex">

                    <!-- Connect Button -->
                    <div style="margin:auto;">
                        <button type="button" class="btn btn-lg" onclick="loginToPhantasma()">Connect</button>
                    </div>

                </div>

                <div style="width:150px;height:45px;margin:20px;display:inline-flex;">
                    <div style="margin:auto;">
                        <button type="button" class="btn btn-lg" onclick="sendDonationScript()">Donate 2
                            Kcal</button>
                    </div>
                </div>
            </div>
        </div>

        <br>

        <div>

            <div class="baseCard">

                <br>
                <div style="margin:auto; width:240px;">
                    <div class="switch-button">
                        <input class="switch-button-checkbox" type="checkbox" id="switchBox" onclick="toggle()"></input>
                        <label class="switch-button-label" for="">
                            <span class="switch-button-label-span">Manual</span>
                        </label>
                    </div>
                </div>
                <div id="manualInputs">
                    <div style="margin:auto; width:350px">
                        <br>
                        <br>
                        <input type:" text" id="contractName" placeholder="Contract Name" class="basicInput"></input>
                        <br>
                        <br>
                        <input type:"text" id="methodName" placeholder="Method Name" class="basicInput"></input>
                        <br>
                        <br>
                        <input type:"text" id="inputArguments" placeholder="Arguments (argument1, argument2, etc...)"
                            class="basicInput"></input>
                    </div>
                    <br>
                    <div style="margin:auto; width:350px">
                        <input type:"text" id="returnBox" placeholder="Returned Data" class="bigField" readonly></input>
                    </div>
                    <br>
                    <div style="width:130px;height:45px;margin:auto;display:inline-flex;padding-left:40px">
                        <div style="margin:auto;">
                            <button type="button" class="btn btn-lg" onclick="updateScriptConfig('document')">Compile Script</button>
                        </div>
                    </div>
                    <div style="width:130px;height:45px;margin:auto;display:inline-flex;padding-left:80px">
                        <div style="margin:auto;">
                            <button type="button" class="btn btn-lg" onclick="invokeSend()">Invoke Script</button>
                        </div>
                    </div>
                </div>

                <div id="scriptInputs" style="display:none">
                    <div style="margin:auto; width:350px">
                        <br>
                        <br>
                        <input type:" text" id="scriptInput" placeholder="Compiled Script" class="bigField"></input>
                    </div>
                </div>

                <br>

                <div style="display:inline-flex; padding-left:40px; padding-right:40px; padding-bottom:50px">
                    <input title="Enable Gas Profile" style="transform: scale(2)" type="checkbox"
                        id="gasProfileCheckbox" onclick="gasProfileToggle()"></checkbox>
                </div>

                <div style="width:200px;height:68px;margin:auto;border-style:double; display:inline-flex;">
                    <div style="width:175px;height:46px;margin:auto;">
                        <button type="button" class="btn btn-lg" style="margin:auto;" onclick="transactionSend()">Send
                            Transaction</button>
                    </div>
                </div>
                <br>
            </div>

        </div>

    </div>


</body>

</html>
